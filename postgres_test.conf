input {
  # test 테이블에서 데이터 가져오기
  jdbc {
    jdbc_driver_library => "C:\ElasticSearch\logstash-8.15.0-windows-x86_64\logstash-8.15.0\lib\mysql-connector-j-9.0.0.jar"
    jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://192.168.0.26:3306/main_project"
    jdbc_user => "user"
    jdbc_password => "mysql"
    jdbc_paging_enabled => true
    tracking_column => "modification_time"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "* * * * *"
    statement => "select * from test"
    type => "test"
  }


  #  cafe_likesorder 뷰에서 데이터 가져오기 (좋아요 많은 추천에 사용)
  jdbc {
    jdbc_driver_library => "C:\ElasticSearch\logstash-8.15.0-windows-x86_64\logstash-8.15.0\lib\mysql-connector-j-9.0.0.jar"
    jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://192.168.0.26:3306/main_project"
    jdbc_user => "user"
    jdbc_password => "mysql"
    jdbc_paging_enabled => true
    tracking_column => "mod_date_like"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "* * * * *"
    statement => "
      SELECT *
      FROM cafe_likesorder
      ORDER BY like_count DESC
      LIMIT 20
    "
    type => "cafe_like_data"
  }
  
  # cafe_reviewsorder 에서 데이터 가져오기 (리뷰 많은 추천에 사용)
  jdbc {
    jdbc_driver_library => "C:\ElasticSearch\logstash-8.15.0-windows-x86_64\logstash-8.15.0\lib\mysql-connector-j-9.0.0.jar"
    jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://192.168.0.26:3306/main_project"
    jdbc_user => "user"
    jdbc_password => "mysql"
    jdbc_paging_enabled => true
    tracking_column => "mod_date_review"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "* * * * *"
    statement => "
      SELECT *
      FROM cafe_reviewsorder
      ORDER BY review_count DESC
      LIMIT 20
    "
    type => "cafe_review_data"
  }

  # cafe_likes_bygender 에서 데이터 가져오기 (성별 추천에 사용)
  jdbc {
    jdbc_driver_library => "C:\ElasticSearch\logstash-8.15.0-windows-x86_64\logstash-8.15.0\lib\mysql-connector-j-9.0.0.jar"
    jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://192.168.0.26:3306/main_project"
    jdbc_user => "user"
    jdbc_password => "mysql"
    jdbc_paging_enabled => true
    tracking_column => "mod_date_genderlikes"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "* * * * *"
    statement => "
      select *
      from cafe_likes_bygender
    "
    type => "cafe_likes_bygender_data"
  }

  # cafe_likes_byage 에서 데이터 가져오기 (연령대별 추천에 사용)
  jdbc {
    jdbc_driver_library => "C:\ElasticSearch\logstash-8.15.0-windows-x86_64\logstash-8.15.0\lib\mysql-connector-j-9.0.0.jar"
    jdbc_driver_class => "com.mysql.cj.jdbc.Driver"
    jdbc_connection_string => "jdbc:mysql://192.168.0.26:3306/main_project"
    jdbc_user => "user"
    jdbc_password => "mysql"
    jdbc_paging_enabled => true
    tracking_column => "mod_date_agelikes"
    use_column_value => true
    tracking_column_type => "timestamp"
    schedule => "* * * * *"
    statement => "
      select *
      from cafe_likes_byage
    "
    type => "cafe_likes_byage_data"
  }
}

output {
  # test 데이터를 Elasticsearch로 전송
  if [type] == "test" {
    elasticsearch {
      hosts => "localhost:9200"
      index => "test240830"
      document_type => "_doc"
      document_id => "%{id}"
      template_api => "legacy"
      ecs_compatibility => "disabled"
    }
  }

  # cafe_likesorder 뷰 데이터를 Elasticsearch로 전송
  if [type] == "cafe_like_data" {
    elasticsearch {
      hosts => "localhost:9200"
      index => "cafe_likes_index"
      document_type => "_doc"
      document_id => "%{cafe_id}"
      template_api => "legacy"
      ecs_compatibility => "disabled"
    }
  }

  # cafe_reviewsorder 데이터를 Elasticsearch로 전송
  if [type] == "cafe_review_data" {
    elasticsearch {
      hosts => "localhost:9200"
      index => "cafe_reviews_index"
      document_type => "_doc"
      document_id => "%{cafe_id}"
      template_api => "legacy"
      ecs_compatibility => "disabled"
    }
  }

  # cafe_likes_bygender 데이터를 Elasticsearch로 전송
  if [type] == "cafe_likes_bygender_data" {
    elasticsearch {
      hosts => ["localhost:9200"]
      index => "cafe_likes_bygender_index"
      document_type => "_doc"
      document_id => "%{cafe_id}-%{gender}"
      template_api => "legacy"
      ecs_compatibility => "disabled"
    }
  }

  # cafe_likes_byage 데이터를 Elasticsearch로 전송
  if [type] == "cafe_likes_byage_data" {
    elasticsearch {
      hosts => ["localhost:9200"]
      index => "cafe_likes_byage_index"
      document_type => "_doc"
      document_id => "%{cafe_id}-%{age_group}"
      template_api => "legacy"
      ecs_compatibility => "disabled"
    }
  }
}